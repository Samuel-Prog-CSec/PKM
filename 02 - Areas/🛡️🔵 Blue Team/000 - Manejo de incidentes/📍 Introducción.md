El **manejo de incidentes** (`IH`, "*Incident Handling*") se ha convertido en una parte importante de la capacidad defensiva de una organización contra el delito cibernético. Si bien las medidas de protección se implementan constantemente para prevenir o reducir la cantidad de incidentes de seguridad, una ==capacidad de manejo de incidentes es innegablemente una necesidad para cualquier organización== que no pueda permitirse un compromiso de su confidencialidad, integridad o disponibilidad de datos. Algunas organizaciones optan por implementar esta capacidad internamente, mientras que otras confían en proveedores externos para apoyarlos, de forma continua o cuando sea necesario. Antes de sumergirnos en el mundo de los incidentes de seguridad, definamos algunos términos y establezcamos una comprensión común de ellos.

Un **event (evento)** es una ==acción que ocurre en un sistema o red==. Ejemplos de eventos son:
- Un usuario enviando un correo electrónico
- Un clic del ratón
- Un firewall que permite una solicitud de conexión

Un **incident (incidente)** es un ==evento con una consecuencia negativa==. Un ejemplo de un incidente es un bloqueo del sistema. Otro ejemplo es el acceso no autorizado a datos confidenciales. Los incidentes también pueden ocurrir debido a desastres naturales, fallas de energía, etc.

No existe una definición única de lo que es un incidente de seguridad de TI y, por lo tanto, varía entre las organizaciones. **Definimos un incidente de seguridad de TI como un evento con una clara intención de causar daño que se realiza contra un sistema informático**. Ejemplos de incidentes son:
- Robo de datos
- Robo de fondos
- Acceso no autorizado a los datos
- Instalación y uso de malware y herramientas de acceso remoto

> [!INFO]
> Incident handling is a clearly defined set of procedures to manage and respond to security incidents in a computer or network environment.

**Es importante tener en cuenta que el manejo de incidentes no se limita solo a incidentes de intrusión**.

Otros tipos de incidentes, como los causados por información privilegiada maliciosa, problemas de disponibilidad y pérdida de propiedad intelectual, también entran dentro del alcance del manejo de incidentes. Un p*lan integral de manejo de incidentes* debe ==abordar varios tipos de incidentes y proporcionar medidas apropiadas para identificar, contener, erradicar y recuperarse de ellos para restaurar las operaciones comerciales normales== de la manera más rápida y eficiente posible.

**Hay algunos eventos sospechosos que deben tratarse como incidentes** a menos que se demuestre lo contrario.

---

# Valor y notas genéricas del manejo de incidentes
Los incidentes de seguridad de TI con frecuencia implican el compromiso de los datos personales y comerciales, y por lo tanto es crucial responder de manera rápida y efectiva. En algunos incidentes, el impacto puede limitarse a unos pocos dispositivos, mientras que en otros una gran parte del entorno puede verse comprometida. Un gran beneficio de que un equipo de manejo de incidentes (a menudo denominado `equipo de respuesta a incidentes`) maneje eventos es que **una fuerza laboral capacitada responderá sistemáticamente y, por lo tanto, se tomarán las medidas apropiadas**. De hecho, el objetivo de dichos equipos es ==minimizar el robo de información o la interrupción de los servicios que está causando el incidente==. 

Debido a que diferentes incidentes tendrán diferentes impactos en la organización, debemos comprender la **importancia de la priorización**. Los incidentes con mayor gravedad requerirán atención inmediata y recursos para ser asignados para ellos, mientras que otros con una calificación más baja también pueden requerir una investigación inicial para comprender si de hecho es un incidente de seguridad de TI con el que estamos lidiando.

El **equipo de manejo de incidentes está dirigido** por un `administrador de incidentes`. Esta función a menudo se asigna a un `administrador de SOC`, `CISO`/`CIO` o proveedor externo (de confianza), y esta persona generalmente también tiene la capacidad de dirigir otras unidades de negocios. El administrador de incidentes ==debe poder obtener información o tener el mandato de exigir a cualquier empleado de la organización que realice una actividad de manera oportuna, si es necesario==. El administrador de incidentes es el ==único punto de comunicación que rastrea las actividades realizadas durante la investigación y su estado de finalización==.

Uno de los **recursos más utilizados en el manejo de incidentes** es [Guía de Manejo de Incidentes de Seguridad Informática del NIST](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf). El documento tiene como objetivo ==ayudar a las organizaciones a mitigar los riesgos de los incidentes de seguridad informática al proporcionar pautas prácticas== para responder a los incidentes de manera efectiva y eficiente.

---

# ¿Qué es la Cadena de Asesinato Cibernético (Cyber Kill Chain)?
Antes de comenzar a hablar sobre el manejo de incidentes, debemos comprender el **ciclo de vida del ataque** (también conocido como la *cadena de muerte cibernética*). Este ciclo de vida ==describe cómo se manifiestan los ataques==. Comprender este ciclo de vida nos proporcionará **información valiosa sobre qué tan lejos está un atacante en la red y a qué puede tener acceso** durante la fase de investigación de un incidente.

La cadena de muerte cibernética *consta de siete etapas diferentes*, como se muestra en la imagen de abajo: ![Diagrama de flujo de los pasos de la cadena de muerte cibernética: Recon, Armonizar, Entregar, Explotar, Instalar, C&C, Acción.](https://academy.hackthebox.com/storage/modules/148/Cyber_kill_chain.png)

1. `recon`: *etapa inicial*, e **involucra la parte donde un atacante elige su objetivo**. Además, el atacante realiza la ==recopilación de información para familiarizarse con el objetivo== y recopila la mayor cantidad de datos útiles posible, que se pueden usar no solo en esta etapa sino también en otras etapas de esta cadena. Algunos atacantes prefieren realizar la recopilación pasiva de información de fuentes web como LinkedIn e Instagram, pero también de documentación en las páginas web de la organización objetivo. Los anuncios de trabajo y los socios de la empresa a menudo revelan información sobre la tecnología utilizada en la organización objetivo. ==Pueden proporcionar información extremadamente específica sobre herramientas antivirus, sistemas operativos y tecnologías de red==. Otros atacantes van un paso más allá; comienzan a escanear activamente las aplicaciones web externas y las direcciones IP que pertenecen a la organización de destino.
2. `weaponize`: el **malware que se utilizará para el acceso inicial se desarrolla e integra en algún tipo de exploit o carga útil** entregable. Este malware está diseñado para ser extremadamente ligero e indetectable por el antivirus y las herramientas de detección. Es probable que el atacante haya recopilado información para identificar el antivirus actual o la tecnología EDR en la organización objetivo. A gran escala, ==el único propósito de esta etapa inicial es proporcionar acceso remoto a una máquina comprometida en el entorno de destino==, que también tiene la capacidad de persistir a través de reinicios de la máquina y la capacidad de implementar herramientas y funcionalidades adicionales a pedido.
3. `delivery`: el **exploit o carga útil se entrega a la víctima(s)**. Los enfoques tradicionales son los correos electrónicos de phishing que contienen un archivo adjunto malicioso o un enlace a una página web. La página web puede ser doble: ya sea conteniendo un exploit o alojando la carga útil maliciosa para evitar enviarla a través de herramientas de escaneo de correo electrónico. Para ser justos, la página web también puede imitar un sitio web legítimo utilizado por la organización objetivo en un intento de engañar a la víctima para que ingrese sus credenciales y las recopile. Algunos atacantes llaman a la víctima por teléfono con un pretexto de ingeniería social en un intento de convencer a la víctima para que ejecute la carga útil. La carga útil en estos casos de confianza se aloja en un sitio web controlado por el atacante que imita un sitio web conocido a la víctima (por ejemplo, una copia del sitio web de la organización objetivo). ==Es extremadamente raro entregar una carga útil que requiere que la víctima haga más de doble clic en un archivo ejecutable o un script== (en entornos de `Windows`, esto puede ser `.bat`, `.cmd`, `.vbs`, `.js`, `.hta` y otros formatos). Finalmente, hay casos en los que se utiliza la interacción física para entregar la carga útil a través de tokens USB y herramientas de almacenamiento similares, que se dejan a propósito.
4. `exploitation`: **momento en que se activa un exploit o una carga útil entregada**. Durante la etapa de explotación de la cadena de muerte cibernética, el atacante generalmente ==intenta ejecutar código en el sistema de destino para obtener acceso o control==.
5. `installation`: el **stager inicial se ejecuta y se ejecuta en la máquina comprometida**. La etapa de instalación se puede llevar a cabo de varias maneras, dependiendo de los objetivos del atacante y la naturaleza del compromiso. Algunas *técnicas comunes utilizadas en la etapa de instalación* incluyen:
	- **Goteros (droppers)**: los atacantes pueden usar goteros para entregar malware en el sistema de destino. Un cuentagotas ==es un pequeño fragmento de código que está diseñado para instalar malware en el sistema y ejecutarlo==. El cuentagotas puede ser entregado a través de diversos medios, tales como archivos adjuntos de correo electrónico, sitios web maliciosos, o tácticas de ingeniería social.
	- **Puertas traseras (backdoors)**: una puerta trasera es un ==tipo de malware que está diseñado para proporcionar al atacante acceso continuo al sistema comprometido==. El atacante puede instalar la puerta trasera durante la etapa de explotación o entregarla a través de un gotero. Una vez instalada, la puerta trasera se puede utilizar *para ejecutar más ataques o robar datos del sistema comprometido*.
	- **Rootkits**: un rootkit es un ==tipo de malware que está diseñado para ocultar su presencia en un sistema comprometido==. Los rootkits se utilizan a menudo en la etapa de instalación *para evadir la detección mediante software antivirus y otras herramientas de seguridad*. El rootkit puede ser instalado por el atacante durante la etapa de explotación o entregado a través de un cuentagotas.
6. `command and control`: el **atacante establece una capacidad de acceso remoto a la máquina comprometida**. No es raro usar un `stager inicial modular` que ==cargue scripts adicionales 'sobre la marcha'==. Sin embargo, los grupos avanzados utilizarán herramientas separadas para garantizar que múltiples variantes de su malware vivan en una red comprometida, y si una de ellas se descubre y contiene, aún tienen los medios para regresar.
7. `action` *(o el objetivo del ataque)*: el **objetivo de cada ataque puede variar**. Algunos adversarios pueden querer filtrar datos confidenciales, mientras que otros pueden querer obtener el mayor nivel de acceso posible dentro de una red para implementar `ransomware`. El `ransomware` es un ==tipo de malware que hará que todos los datos almacenados en dispositivos y servidores de punto final sean inutilizables o inaccesibles== a menos que se pague un rescate dentro de un plazo limitado (**no recomendado**).

Es **importante entender que los adversarios no operarán de manera lineal** (como muestra la cadena de asesinatos cibernéticos). ==Algunas etapas anteriores de la cadena de muerte cibernética se repetirán una y otra vez==. Si tomamos, por ejemplo, el `installation` de un compromiso exitoso, el siguiente paso lógico para un adversario en el futuro es iniciar el `recon`, para identificar objetivos adicionales y encontrar vulnerabilidades para explotar, de modo que se mueva más profundamente en la red y finalmente logre el objetivo(s) del ataque.

Nuestro objetivo es **frenar al atacante en su progreso para finalizar la cadena de muerte cibernética** ==(idealmente en una de las primeras etapas)==.